<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FON ‚Äî Friday War Room</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@400;500&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0a0a0f;
  --panel: #111118;
  --border: #1e1e2e;
  --hot: #ff3d3d;
  --cold: #3d9fff;
  --gold: #ffd44d;
  --green: #00e676;
  --amber: #ffb300;
  --text: #f0f0f0;
  --muted: #555570;
  --label: #888899;
  --navy: #1D3557;
  --p0: #ff3d3d;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  min-height: 100vh;
  overflow-x: hidden;
}

/* animated background grid */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image:
    linear-gradient(rgba(255,61,61,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,61,61,0.03) 1px, transparent 1px);
  background-size: 40px 40px;
  pointer-events: none;
  z-index: 0;
}

/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
.header {
  position: relative;
  z-index: 10;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px 32px;
  border-bottom: 1px solid var(--border);
  background: rgba(10,10,15,0.95);
  backdrop-filter: blur(10px);
}

.header-left { display: flex; align-items: center; gap: 16px; }

.logo {
  font-family: 'Bebas Neue', cursive;
  font-size: 28px;
  letter-spacing: 3px;
  color: var(--text);
}
.logo span { color: var(--hot); }

.live-badge {
  display: flex; align-items: center; gap: 6px;
  background: rgba(255,61,61,0.12);
  border: 1px solid rgba(255,61,61,0.3);
  border-radius: 20px;
  padding: 4px 12px;
  font-size: 11px;
  font-weight: 600;
  color: var(--hot);
  letter-spacing: 1px;
  text-transform: uppercase;
}
.live-dot {
  width: 6px; height: 6px;
  border-radius: 50%;
  background: var(--hot);
  animation: pulse 1.5s ease-in-out infinite;
}
@keyframes pulse {
  0%,100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.4; transform: scale(0.8); }
}

.header-right {
  display: flex; align-items: center; gap: 20px;
  font-size: 12px; color: var(--label);
}

.week-label {
  font-family: 'DM Mono', monospace;
  font-size: 12px;
  color: var(--gold);
  letter-spacing: 1px;
}

/* ‚îÄ‚îÄ NAV TABS ‚îÄ‚îÄ */
.pathway-nav {
  position: relative;
  z-index: 10;
  display: flex;
  gap: 4px;
  padding: 16px 32px 0;
  border-bottom: 1px solid var(--border);
  background: rgba(10,10,15,0.9);
}

.pathway-tab {
  padding: 10px 24px;
  font-family: 'Bebas Neue', cursive;
  font-size: 18px;
  letter-spacing: 2px;
  color: var(--muted);
  cursor: pointer;
  border-bottom: 3px solid transparent;
  transition: all 0.2s;
  background: none;
  border-top: none;
  border-left: none;
  border-right: none;
}
.pathway-tab:hover { color: var(--text); }
.pathway-tab.active {
  color: var(--hot);
  border-bottom-color: var(--hot);
}

.add-pathway-btn {
  padding: 10px 20px;
  font-size: 18px;
  color: var(--muted);
  cursor: pointer;
  background: none;
  border: none;
  transition: color 0.2s;
  font-family: 'Bebas Neue', cursive;
  letter-spacing: 1px;
}
.add-pathway-btn:hover { color: var(--gold); }

/* ‚îÄ‚îÄ MAIN LAYOUT ‚îÄ‚îÄ */
.main {
  position: relative;
  z-index: 5;
  padding: 28px 32px;
  display: grid;
  grid-template-columns: 1fr 320px;
  gap: 20px;
  max-width: 1400px;
  margin: 0 auto;
}

/* ‚îÄ‚îÄ PATHWAY PANEL ‚îÄ‚îÄ */
.pathway-panel { display: flex; flex-direction: column; gap: 16px; }

/* ‚îÄ‚îÄ CARDS ‚îÄ‚îÄ */
.card {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px 22px;
  position: relative;
  overflow: hidden;
}

.card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.06), transparent);
}

.card-label {
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--label);
  margin-bottom: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.card-label::after {
  content: '';
  flex: 1;
  height: 1px;
  background: var(--border);
}

/* ‚îÄ‚îÄ PATHWAY HEADER CARD ‚îÄ‚îÄ */
.pathway-header-card {
  background: linear-gradient(135deg, #13131f 0%, #0f1020 100%);
  border-color: rgba(255,61,61,0.2);
}

.pathway-title-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
}

.pathway-name {
  font-family: 'Bebas Neue', cursive;
  font-size: 52px;
  letter-spacing: 4px;
  color: var(--text);
  line-height: 1;
}

.ads-live-badge {
  text-align: right;
}
.ads-live-num {
  font-family: 'Bebas Neue', cursive;
  font-size: 64px;
  color: var(--hot);
  line-height: 1;
  text-shadow: 0 0 40px rgba(255,61,61,0.4);
}
.ads-live-label {
  font-size: 10px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--label);
  text-align: right;
}

/* ‚îÄ‚îÄ STATS ROW ‚îÄ‚îÄ */
.stats-row {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

.stat-block {
  background: rgba(255,255,255,0.03);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 14px 16px;
  position: relative;
}

.stat-block.earn { border-color: rgba(0,230,118,0.2); }
.stat-block.spend { border-color: rgba(255,61,61,0.15); }
.stat-block.roas { border-color: rgba(255,212,77,0.2); }

.stat-label {
  font-size: 10px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--label);
  margin-bottom: 6px;
}

.stat-value {
  font-family: 'Bebas Neue', cursive;
  font-size: 32px;
  letter-spacing: 1px;
  line-height: 1;
}

.stat-value.earn { color: var(--green); }
.stat-value.spend { color: var(--text); }
.stat-value.roas { color: var(--gold); }

.stat-sub {
  font-size: 10px;
  color: var(--muted);
  margin-top: 4px;
}

.stat-input {
  background: none;
  border: none;
  font-family: 'Bebas Neue', cursive;
  font-size: 32px;
  letter-spacing: 1px;
  line-height: 1;
  width: 100%;
  outline: none;
  cursor: text;
}
.stat-input.earn { color: var(--green); }
.stat-input.spend { color: var(--text); }
.stat-input.roas { color: var(--gold); }
.stat-input::placeholder { color: rgba(255,255,255,0.1); }

/* ‚îÄ‚îÄ CREATIVE SPLIT ‚îÄ‚îÄ */
.split-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.split-block {
  background: rgba(255,255,255,0.02);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 14px 16px;
}

.split-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 10px;
}

.split-type {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 1px;
  text-transform: uppercase;
  color: var(--text);
}

.split-count {
  font-family: 'Bebas Neue', cursive;
  font-size: 24px;
  color: var(--gold);
}

.split-bar-wrap {
  background: rgba(255,255,255,0.05);
  border-radius: 4px;
  height: 6px;
  margin-bottom: 6px;
  overflow: hidden;
}

.split-bar {
  height: 6px;
  border-radius: 4px;
  transition: width 0.6s ease;
}
.split-bar.reels { background: linear-gradient(90deg, var(--hot), #ff8c42); }
.split-bar.statics { background: linear-gradient(90deg, var(--cold), #7b9fff); }

.split-historic {
  font-size: 10px;
  color: var(--label);
}
.split-historic span { color: var(--amber); font-weight: 600; }

/* ‚îÄ‚îÄ STRATEGY PERFORMANCE ‚îÄ‚îÄ */
.strategy-grid {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.strategy-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 14px;
  border-radius: 8px;
  border: 1px solid transparent;
  transition: all 0.2s;
  cursor: default;
}

.strategy-row.hot {
  background: rgba(255,61,61,0.08);
  border-color: rgba(255,61,61,0.2);
}
.strategy-row.warm {
  background: rgba(255,179,0,0.06);
  border-color: rgba(255,179,0,0.15);
}
.strategy-row.cold {
  background: rgba(255,255,255,0.02);
  border-color: var(--border);
}

.strategy-tag {
  font-family: 'Bebas Neue', cursive;
  font-size: 18px;
  letter-spacing: 1px;
  width: 32px;
  flex-shrink: 0;
}
.strategy-row.hot .strategy-tag { color: var(--hot); }
.strategy-row.warm .strategy-tag { color: var(--amber); }
.strategy-row.cold .strategy-tag { color: var(--muted); }

.strategy-desc {
  flex: 1;
  font-size: 12px;
  color: var(--text);
  line-height: 1.4;
}
.strategy-desc span { display: block; font-size: 11px; color: var(--label); margin-top: 1px; }

.heat-indicator {
  font-size: 16px;
}

.strategy-note {
  font-size: 10px;
  color: var(--muted);
  font-family: 'DM Mono', monospace;
}

/* ‚îÄ‚îÄ HISTORIC PERFORMANCE ‚îÄ‚îÄ */
.historic-row {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  gap: 10px;
}

.historic-block {
  text-align: center;
  padding: 12px;
  background: rgba(255,255,255,0.02);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.historic-val {
  font-family: 'Bebas Neue', cursive;
  font-size: 22px;
  line-height: 1;
  margin-bottom: 4px;
}

.historic-val.earn { color: var(--green); }
.historic-val.spend { color: var(--text); }
.historic-val.roas { color: var(--gold); }
.historic-val.be {
  color: var(--hot);
  font-size: 20px;
}

.historic-lbl {
  font-size: 9px;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: var(--label);
}

.historic-input {
  background: none;
  border: none;
  font-family: 'Bebas Neue', cursive;
  font-size: 22px;
  line-height: 1;
  text-align: center;
  width: 100%;
  outline: none;
  cursor: text;
}
.historic-input.earn { color: var(--green); }
.historic-input.spend { color: var(--text); }
.historic-input.roas { color: var(--gold); }
.historic-input.be { color: var(--hot); font-size: 20px; }
.historic-input::placeholder { color: rgba(255,255,255,0.08); }

/* ‚îÄ‚îÄ P0 SUGGESTIONS PANEL ‚îÄ‚îÄ */
.suggestions-panel {
  display: flex;
  flex-direction: column;
  gap: 16px;
  position: sticky;
  top: 20px;
}

.p0-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 4px;
}

.p0-tag {
  background: var(--p0);
  color: white;
  font-family: 'Bebas Neue', cursive;
  font-size: 16px;
  letter-spacing: 2px;
  padding: 3px 10px;
  border-radius: 4px;
}

.p0-title {
  font-family: 'Bebas Neue', cursive;
  font-size: 20px;
  letter-spacing: 2px;
  color: var(--text);
}

.p0-subtitle {
  font-size: 11px;
  color: var(--muted);
  margin-bottom: 14px;
  line-height: 1.5;
}

/* suggestion items */
.suggestion-item {
  display: flex;
  gap: 10px;
  padding: 12px 14px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,0.02);
  margin-bottom: 6px;
  transition: border-color 0.2s;
}

.suggestion-item:hover { border-color: rgba(255,61,61,0.3); }

.suggestion-item.scale { border-left: 3px solid var(--green); }
.suggestion-item.kill { border-left: 3px solid var(--hot); }
.suggestion-item.iterate { border-left: 3px solid var(--amber); }
.suggestion-item.headline { border-left: 3px solid var(--cold); }
.suggestion-item.strategy { border-left: 3px solid #b388ff; }
.suggestion-item.adset { border-left: 3px solid var(--gold); }

.sug-type {
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  width: 52px;
  flex-shrink: 0;
  padding-top: 2px;
  line-height: 1.3;
}
.scale .sug-type { color: var(--green); }
.kill .sug-type { color: var(--hot); }
.iterate .sug-type { color: var(--amber); }
.headline .sug-type { color: var(--cold); }
.strategy .sug-type { color: #b388ff; }
.adset .sug-type { color: var(--gold); }

.sug-text {
  font-size: 12px;
  color: var(--text);
  line-height: 1.5;
  flex: 1;
}

.sug-text small {
  display: block;
  font-size: 10px;
  color: var(--label);
  margin-top: 3px;
}

/* add suggestion */
.add-sug-btn {
  width: 100%;
  padding: 10px;
  background: rgba(255,61,61,0.06);
  border: 1px dashed rgba(255,61,61,0.2);
  border-radius: 8px;
  color: var(--muted);
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s;
  font-family: 'DM Sans', sans-serif;
}
.add-sug-btn:hover { border-color: var(--hot); color: var(--hot); }

/* ‚îÄ‚îÄ MODAL for adding suggestions ‚îÄ‚îÄ */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  backdrop-filter: blur(4px);
  z-index: 100;
  display: none;
  align-items: center;
  justify-content: center;
}
.modal-overlay.open { display: flex; }

.modal {
  background: #15151f;
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 28px;
  width: 440px;
  max-width: 95vw;
}

.modal-title {
  font-family: 'Bebas Neue', cursive;
  font-size: 24px;
  letter-spacing: 2px;
  margin-bottom: 20px;
  color: var(--text);
}

.modal select,
.modal textarea,
.modal input {
  width: 100%;
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--border);
  border-radius: 8px;
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  font-size: 13px;
  padding: 10px 12px;
  margin-bottom: 12px;
  outline: none;
  transition: border-color 0.2s;
}
.modal select:focus,
.modal textarea:focus,
.modal input:focus { border-color: var(--hot); }
.modal textarea { height: 80px; resize: none; }
.modal select option { background: #15151f; }

.modal-btns { display: flex; gap: 10px; justify-content: flex-end; margin-top: 8px; }

.btn {
  padding: 9px 20px;
  border-radius: 7px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  border: none;
  transition: all 0.2s;
  font-family: 'DM Sans', sans-serif;
}
.btn-cancel { background: rgba(255,255,255,0.06); color: var(--label); }
.btn-cancel:hover { background: rgba(255,255,255,0.1); }
.btn-add { background: var(--hot); color: white; }
.btn-add:hover { background: #ff5555; }

/* ‚îÄ‚îÄ PATHWAY MODAL ‚îÄ‚îÄ */
.pathway-modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  backdrop-filter: blur(4px);
  z-index: 100;
  display: none;
  align-items: center;
  justify-content: center;
}
.pathway-modal-overlay.open { display: flex; }

/* ‚îÄ‚îÄ LOCK DECISIONS BAR ‚îÄ‚îÄ */
.lock-bar {
  position: fixed;
  bottom: 0; left: 0; right: 0;
  background: rgba(10,10,15,0.98);
  border-top: 1px solid var(--border);
  padding: 14px 32px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  z-index: 50;
  backdrop-filter: blur(10px);
}

.lock-bar-left {
  font-family: 'Bebas Neue', cursive;
  font-size: 16px;
  letter-spacing: 2px;
  color: var(--label);
}

.lock-decisions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.lock-chip {
  padding: 6px 14px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  border: 1px solid var(--border);
  background: rgba(255,255,255,0.03);
  color: var(--muted);
  transition: all 0.2s;
  user-select: none;
}
.lock-chip:hover { border-color: var(--amber); color: var(--amber); }
.lock-chip.locked {
  background: rgba(0,230,118,0.1);
  border-color: var(--green);
  color: var(--green);
}

.lock-all-btn {
  padding: 8px 22px;
  background: var(--hot);
  color: white;
  border: none;
  border-radius: 7px;
  font-size: 12px;
  font-weight: 700;
  cursor: pointer;
  font-family: 'DM Sans', sans-serif;
  letter-spacing: 0.5px;
  transition: all 0.2s;
  white-space: nowrap;
}
.lock-all-btn:hover { background: #ff5555; }
.lock-all-btn.all-locked {
  background: var(--green);
}

/* ‚îÄ‚îÄ EDITABLE FIELDS ‚îÄ‚îÄ */
[contenteditable="true"] {
  outline: none;
  border-bottom: 1px dashed rgba(255,255,255,0.1);
  cursor: text;
  transition: border-color 0.2s;
}
[contenteditable="true"]:focus {
  border-bottom-color: var(--hot);
}

.edit-hint {
  font-size: 9px;
  color: var(--muted);
  letter-spacing: 1px;
  text-transform: uppercase;
  display: flex;
  align-items: center;
  gap: 4px;
  margin-top: 2px;
}

/* scrollbar */
::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

/* padding for lock bar */
.main { padding-bottom: 80px; }
</style>
</head>
<body>

<!-- HEADER -->
<div class="header">
  <div class="header-left">
    <div class="logo">FON <span>//</span> WAR ROOM</div>
    <div class="live-badge"><div class="live-dot"></div>FRIDAY REVIEW</div>
  </div>
  <div class="header-right">
    <span class="week-label" id="week-display">WEEK ‚Äî ‚Äî</span>
    <span style="color:var(--border)">|</span>
    <button onclick="openImportModal()" style="background:rgba(255,212,77,0.12);border:1px solid rgba(255,212,77,0.35);color:var(--gold);font-family:'DM Sans',sans-serif;font-size:12px;font-weight:700;padding:7px 16px;border-radius:7px;cursor:pointer;letter-spacing:0.5px;transition:all 0.2s;" onmouseover="this.style.background='rgba(255,212,77,0.22)'" onmouseout="this.style.background='rgba(255,212,77,0.12)'">‚ö° LOAD META DATA</button>
  </div>
</div>

<!-- PATHWAY TABS -->
<div class="pathway-nav" id="pathway-nav">
  <!-- tabs injected by JS -->
  <button class="add-pathway-btn" onclick="openAddPathway()">+ ADD PATHWAY</button>
</div>

<!-- MAIN CONTENT -->
<div class="main" id="main-content">
  <!-- left: pathway panel -->
  <div class="pathway-panel" id="pathway-panel">
    <!-- injected by JS -->
  </div>

  <!-- right: P0 suggestions -->
  <div class="suggestions-panel" id="suggestions-panel">
    <div>
      <div class="p0-header">
        <div class="p0-tag">P0</div>
        <div class="p0-title">THIS WEEK'S CALLS</div>
      </div>
      <div class="p0-subtitle">High priority actions only. Paste from Prompt 1 output or add manually.</div>
    </div>
    <div id="suggestions-list"></div>
    <button class="add-sug-btn" onclick="openAddSuggestion()">+ Add P0 suggestion</button>
  </div>
</div>

<!-- LOCK BAR -->
<div class="lock-bar">
  <div class="lock-bar-left">LOCK DECISIONS</div>
  <div class="lock-decisions" id="lock-decisions">
    <!-- injected by JS -->
  </div>
  <button class="lock-all-btn" id="lock-all-btn" onclick="lockAll()">LOCK ALL</button>
</div>

<!-- ADD SUGGESTION MODAL -->
<div class="modal-overlay" id="sug-modal">
  <div class="modal">
    <div class="modal-title">ADD P0 SUGGESTION</div>
    <select id="sug-type">
      <option value="scale">SCALE</option>
      <option value="kill">KILL</option>
      <option value="iterate">ITERATE</option>
      <option value="headline">HEADLINE OPTION</option>
      <option value="strategy">NEW STRATEGY</option>
      <option value="adset">AD SET UPDATE</option>
    </select>
    <input type="text" id="sug-title" placeholder="Ad name / concept name..." />
    <textarea id="sug-body" placeholder="Specific action or recommendation..."></textarea>
    <div class="modal-btns">
      <button class="btn btn-cancel" onclick="closeSugModal()">Cancel</button>
      <button class="btn btn-add" onclick="addSuggestion()">Add</button>
    </div>
  </div>
</div>

<!-- ADD PATHWAY MODAL -->
<div class="pathway-modal-overlay" id="pathway-modal">
  <div class="modal">
    <div class="modal-title">ADD PATHWAY</div>
    <input type="text" id="new-pathway-name" placeholder="Pathway name e.g. A3, B1..." maxlength="6" style="text-transform:uppercase;font-family:'Bebas Neue',cursive;font-size:24px;letter-spacing:3px;" />
    <input type="text" id="new-pathway-desc" placeholder="Description e.g. OneLife ‚Äî Avatar 3..." />
    <div class="modal-btns">
      <button class="btn btn-cancel" onclick="closePathwayModal()">Cancel</button>
      <button class="btn btn-add" onclick="addPathway()">Add Pathway</button>
    </div>
  </div>
</div>

<script>
// ‚îÄ‚îÄ DATA MODEL ‚îÄ‚îÄ
const pathways = [
  {
    id: 'A1',
    name: 'A1',
    desc: 'OneFit ‚Äî Avatar 1 + 2',
    adsLive: '',
    earn7: '', spend7: '', roas7: '',
    reelsLive: '', staticsLive: '',
    reelsHistoricWin: '73',
    staticsHistoricWin: '27',
    reelStrategies: [
      { tag: 'S3', name: 'Hybrid', desc: 'Hook ‚Üí Benefit ‚Üí Proof ‚Üí CTA', heat: 'hot' },
      { tag: 'S2', name: 'Hook-Led', desc: 'Attention ‚Üí Curiosity ‚Üí Emotion', heat: 'warm' },
      { tag: 'S0', name: 'Free For All', desc: 'Creative exploration ‚Äî no rules', heat: 'cold' },
    ],
    staticStrategies: [
      { tag: 'S1', name: 'Benefit-Led', desc: 'Benefit ‚Üí Positioning ‚Üí Emotion ‚Üí Clarity', heat: 'hot' },
      { tag: 'S3', name: 'Hybrid', desc: 'Hook ‚Üí Benefit ‚Üí Proof ‚Üí CTA', heat: 'warm' },
    ],
    historicEarn: '', historicSpend: '', historicRoas: '',
    breakevenRoas: '',
    suggestions: []
  },
  {
    id: 'B2',
    name: 'B2',
    desc: 'Retargeting ‚Äî ATC + IC No Sale',
    adsLive: '',
    earn7: '', spend7: '', roas7: '',
    reelsLive: '', staticsLive: '',
    reelsHistoricWin: '55',
    staticsHistoricWin: '45',
    reelStrategies: [
      { tag: 'S3', name: 'Hybrid', desc: 'Hook ‚Üí Benefit ‚Üí Proof ‚Üí CTA', heat: 'hot' },
      { tag: 'S0', name: 'Free For All', desc: 'Creative exploration ‚Äî no rules', heat: 'warm' },
    ],
    staticStrategies: [
      { tag: 'S1', name: 'Benefit-Led', desc: 'Benefit ‚Üí Positioning ‚Üí Emotion ‚Üí Clarity', heat: 'hot' },
      { tag: 'S2', name: 'Hook-Led', desc: 'Pattern interrupt + open loop', heat: 'cold' },
    ],
    historicEarn: '', historicSpend: '', historicRoas: '',
    breakevenRoas: '',
    suggestions: []
  }
];

let activePathwayId = 'A1';
const lockState = {
  'Product split': false,
  'Strategy split': false,
  'Avatar priorities': false,
  'Format split': false,
  'LP routing': false,
  'Ad sets (Akaash)': false,
  'Kills + scales': false,
};

// ‚îÄ‚îÄ WEEK DISPLAY ‚îÄ‚îÄ
function getWeekDisplay() {
  const now = new Date();
  const day = now.getDate();
  const month = now.toLocaleString('en-AU', { month: 'short' }).toUpperCase();
  const year = now.getFullYear();
  document.getElementById('week-display').textContent = `WEEK OF ${day} ${month} ${year}`;
}
getWeekDisplay();

// ‚îÄ‚îÄ RENDER TABS ‚îÄ‚îÄ
function renderTabs() {
  const nav = document.getElementById('pathway-nav');
  const addBtn = nav.querySelector('.add-pathway-btn');
  nav.querySelectorAll('.pathway-tab').forEach(t => t.remove());
  pathways.forEach(p => {
    const btn = document.createElement('button');
    btn.className = 'pathway-tab' + (p.id === activePathwayId ? ' active' : '');
    btn.textContent = p.id;
    btn.onclick = () => { activePathwayId = p.id; renderAll(); };
    nav.insertBefore(btn, addBtn);
  });
}

// ‚îÄ‚îÄ RENDER PATHWAY PANEL ‚îÄ‚îÄ
function renderPathway() {
  const p = pathways.find(x => x.id === activePathwayId);
  if (!p) return;
  const panel = document.getElementById('pathway-panel');

  const reelPct = parseInt(p.reelsHistoricWin) || 0;
  const staticPct = parseInt(p.staticsHistoricWin) || 0;

  const totalLive = (parseInt(p.reelsLive)||0) + (parseInt(p.staticsLive)||0);

  panel.innerHTML = `
    <!-- PATHWAY HEADER -->
    <div class="card pathway-header-card">
      <div class="pathway-title-row">
        <div>
          <div class="pathway-name">${p.name}</div>
          <div style="font-size:12px;color:var(--label);margin-top:4px;">${p.desc}</div>
        </div>
        <div class="ads-live-badge">
          <div class="ads-live-num" contenteditable="true" oninput="updateField('${p.id}','adsLive',this.innerText)">${p.adsLive || '<span style="opacity:0.15;font-size:40px;">‚Äî</span>'}</div>
          <div class="ads-live-label">Ads Live</div>
          <div class="edit-hint">‚úé click to edit</div>
        </div>
      </div>
      <!-- 7-DAY STATS -->
      <div class="card-label">Last 7 Days</div>
      <div class="stats-row">
        <div class="stat-block earn">
          <div class="stat-label">Earned</div>
          <input class="stat-input earn" placeholder="$0" value="${p.earn7}" oninput="updateField('${p.id}','earn7',this.value)" />
          <div class="stat-sub">revenue 7d</div>
        </div>
        <div class="stat-block spend">
          <div class="stat-label">Spent</div>
          <input class="stat-input spend" placeholder="$0" value="${p.spend7}" oninput="updateField('${p.id}','spend7',this.value)" />
          <div class="stat-sub">ad spend 7d</div>
        </div>
        <div class="stat-block roas">
          <div class="stat-label">ROAS</div>
          <input class="stat-input roas" placeholder="0.0x" value="${p.roas7}" oninput="updateField('${p.id}','roas7',this.value)" />
          <div class="stat-sub">7-day blended</div>
        </div>
      </div>
    </div>

    <!-- CREATIVE SPLIT -->
    <div class="card">
      <div class="card-label">Creative Split ‚Äî Live This Week</div>
      <div class="split-row">
        <div class="split-block">
          <div class="split-header">
            <div class="split-type">üé¨ Reels</div>
            <input style="background:none;border:none;font-family:'Bebas Neue',cursive;font-size:24px;color:var(--gold);width:60px;text-align:right;outline:none;" placeholder="0" value="${p.reelsLive}" oninput="updateField('${p.id}','reelsLive',this.value)" />
          </div>
          <div class="split-bar-wrap">
            <div class="split-bar reels" style="width:${reelPct}%"></div>
          </div>
          <div class="split-historic">Historic win rate: <span>${reelPct}%</span></div>
        </div>
        <div class="split-block">
          <div class="split-header">
            <div class="split-type">üñº Statics</div>
            <input style="background:none;border:none;font-family:'Bebas Neue',cursive;font-size:24px;color:var(--gold);width:60px;text-align:right;outline:none;" placeholder="0" value="${p.staticsLive}" oninput="updateField('${p.id}','staticsLive',this.value)" />
          </div>
          <div class="split-bar-wrap">
            <div class="split-bar statics" style="width:${staticPct}%"></div>
          </div>
          <div class="split-historic">Historic win rate: <span>${staticPct}%</span></div>
        </div>
      </div>
    </div>

    <!-- STRATEGY PERFORMANCE -->
    <div class="card">
      <div class="card-label">üé¨ Reel Strategies ‚Äî What's Working</div>
      <div class="strategy-grid">
        ${p.reelStrategies.map(s => renderStrategyRow(s)).join('')}
      </div>
    </div>
    <div class="card">
      <div class="card-label">üñº Static Strategies ‚Äî What's Working</div>
      <div class="strategy-grid">
        ${p.staticStrategies.map(s => renderStrategyRow(s)).join('')}
      </div>
    </div>

    <!-- HISTORIC PERFORMANCE -->
    <div class="card">
      <div class="card-label">Historic Performance ‚Äî All Time</div>
      <div class="historic-row">
        <div class="historic-block">
          <input class="historic-input earn" placeholder="$‚Äî" value="${p.historicEarn}" oninput="updateField('${p.id}','historicEarn',this.value)" />
          <div class="historic-lbl">Total Earned</div>
        </div>
        <div class="historic-block">
          <input class="historic-input spend" placeholder="$‚Äî" value="${p.historicSpend}" oninput="updateField('${p.id}','historicSpend',this.value)" />
          <div class="historic-lbl">Total Spent</div>
        </div>
        <div class="historic-block">
          <input class="historic-input roas" placeholder="0.0x" value="${p.historicRoas}" oninput="updateField('${p.id}','historicRoas',this.value)" />
          <div class="historic-lbl">Historic ROAS</div>
        </div>
        <div class="historic-block">
          <input class="historic-input be" placeholder="0.0x" value="${p.breakevenRoas}" oninput="updateField('${p.id}','breakevenRoas',this.value)" />
          <div class="historic-lbl">Breakeven ROAS</div>
        </div>
      </div>
    </div>
  `;
}

function renderStrategyRow(s) {
  const icons = { hot: 'üî•', warm: '‚ö°', cold: '‚ùÑÔ∏è' };
  return `
    <div class="strategy-row ${s.heat}">
      <div class="strategy-tag">${s.tag}</div>
      <div class="strategy-desc">
        ${s.name}
        <span>${s.desc}</span>
      </div>
      <div class="heat-indicator">${icons[s.heat]}</div>
    </div>
  `;
}

// ‚îÄ‚îÄ RENDER SUGGESTIONS ‚îÄ‚îÄ
function renderSuggestions() {
  const p = pathways.find(x => x.id === activePathwayId);
  const list = document.getElementById('suggestions-list');
  if (!p || p.suggestions.length === 0) {
    list.innerHTML = `<div style="font-size:12px;color:var(--muted);text-align:center;padding:20px 0;border:1px dashed var(--border);border-radius:8px;">No P0 suggestions yet.<br>Paste from Prompt 1 output or add manually.</div>`;
    return;
  }
  list.innerHTML = p.suggestions.map((s, i) => `
    <div class="suggestion-item ${s.type}" style="position:relative;">
      <div class="sug-type">${s.type.toUpperCase()}</div>
      <div class="sug-text">
        <strong>${s.title}</strong>
        <small>${s.body}</small>
      </div>
      <div onclick="removeSuggestion('${p.id}', ${i})" style="position:absolute;top:8px;right:8px;cursor:pointer;color:var(--muted);font-size:14px;line-height:1;" title="Remove">√ó</div>
    </div>
  `).join('');
}

// ‚îÄ‚îÄ RENDER LOCK BAR ‚îÄ‚îÄ
function renderLockBar() {
  const container = document.getElementById('lock-decisions');
  container.innerHTML = '';
  Object.entries(lockState).forEach(([label, locked]) => {
    const chip = document.createElement('div');
    chip.className = 'lock-chip' + (locked ? ' locked' : '');
    chip.textContent = (locked ? '‚úì ' : '') + label;
    chip.onclick = () => { lockState[label] = !locked; renderLockBar(); };
    container.appendChild(chip);
  });
  const allLocked = Object.values(lockState).every(Boolean);
  const btn = document.getElementById('lock-all-btn');
  btn.className = 'lock-all-btn' + (allLocked ? ' all-locked' : '');
  btn.textContent = allLocked ? '‚úì ALL LOCKED' : 'LOCK ALL';
}

function lockAll() {
  Object.keys(lockState).forEach(k => lockState[k] = true);
  renderLockBar();
}

// ‚îÄ‚îÄ UPDATE FIELD ‚îÄ‚îÄ
function updateField(pathwayId, field, value) {
  const p = pathways.find(x => x.id === pathwayId);
  if (p) p[field] = value.trim();
}

// ‚îÄ‚îÄ SUGGESTION MODAL ‚îÄ‚îÄ
function openAddSuggestion() {
  document.getElementById('sug-modal').classList.add('open');
  document.getElementById('sug-title').focus();
}
function closeSugModal() {
  document.getElementById('sug-modal').classList.remove('open');
  document.getElementById('sug-title').value = '';
  document.getElementById('sug-body').value = '';
}
function addSuggestion() {
  const p = pathways.find(x => x.id === activePathwayId);
  const type = document.getElementById('sug-type').value;
  const title = document.getElementById('sug-title').value.trim();
  const body = document.getElementById('sug-body').value.trim();
  if (!title) return;
  p.suggestions.push({ type, title, body });
  closeSugModal();
  renderSuggestions();
}
function removeSuggestion(pathwayId, index) {
  const p = pathways.find(x => x.id === pathwayId);
  p.suggestions.splice(index, 1);
  renderSuggestions();
}

// ‚îÄ‚îÄ PATHWAY MODAL ‚îÄ‚îÄ
function openAddPathway() {
  document.getElementById('pathway-modal').classList.add('open');
  document.getElementById('new-pathway-name').focus();
}
function closePathwayModal() {
  document.getElementById('pathway-modal').classList.remove('open');
  document.getElementById('new-pathway-name').value = '';
  document.getElementById('new-pathway-desc').value = '';
}
function addPathway() {
  const name = document.getElementById('new-pathway-name').value.trim().toUpperCase();
  const desc = document.getElementById('new-pathway-desc').value.trim();
  if (!name) return;
  pathways.push({
    id: name, name, desc: desc || 'New pathway',
    adsLive: '', earn7: '', spend7: '', roas7: '',
    reelsLive: '', staticsLive: '',
    reelsHistoricWin: '50', staticsHistoricWin: '50',
    reelStrategies: [
      { tag: 'S3', name: 'Hybrid', desc: 'Hook ‚Üí Benefit ‚Üí Proof ‚Üí CTA', heat: 'warm' },
    ],
    staticStrategies: [
      { tag: 'S1', name: 'Benefit-Led', desc: 'Benefit ‚Üí Positioning ‚Üí Emotion ‚Üí Clarity', heat: 'warm' },
    ],
    historicEarn: '', historicSpend: '', historicRoas: '',
    breakevenRoas: '',
    suggestions: []
  });
  activePathwayId = name;
  closePathwayModal();
  renderAll();
}

// close modals on overlay click
document.getElementById('sug-modal').addEventListener('click', function(e) {
  if (e.target === this) closeSugModal();
});
document.getElementById('pathway-modal').addEventListener('click', function(e) {
  if (e.target === this) closePathwayModal();
});

// ‚îÄ‚îÄ RENDER ALL ‚îÄ‚îÄ
function renderAll() {
  renderTabs();
  renderPathway();
  renderSuggestions();
  renderLockBar();
}

renderAll();
</script>

<!-- IMPORT MODAL ‚Äî JSON PASTE -->
<div class="modal-overlay" id="import-modal" style="display:none;align-items:center;justify-content:center;z-index:200;">
  <div class="modal" style="width:660px;max-width:96vw;max-height:90vh;overflow-y:auto;">

    <!-- STEP INDICATOR -->
    <div style="display:flex;gap:8px;margin-bottom:20px;">
      <div id="step-ind-1" style="flex:1;height:3px;border-radius:2px;background:var(--hot);transition:background 0.3s;"></div>
      <div id="step-ind-2" style="flex:1;height:3px;border-radius:2px;background:var(--border);transition:background 0.3s;"></div>
    </div>

    <!-- STEP 1: COPY PROMPT -->
    <div id="import-step1">
      <div class="modal-title">STEP 1 ‚Äî GET YOUR DATA</div>
      <div style="font-size:12px;color:var(--label);margin-bottom:16px;line-height:1.7;">
        Copy the prompt below, then open a <strong style="color:var(--text);">new Claude chat</strong>. Paste the prompt, then paste your Meta CSV underneath it. Claude will output a JSON block. Come back here for Step 2.
      </div>

      <!-- PROMPT BOX -->
      <div style="position:relative;margin-bottom:14px;">
        <div style="background:#0d0d18;border:1px solid var(--border);border-radius:8px;padding:16px;font-family:'DM Mono',monospace;font-size:11px;color:#c8c8e0;line-height:1.8;max-height:260px;overflow-y:auto;white-space:pre-wrap;" id="eve-prompt-box"></div>
        <button onclick="copyEvePrompt(this)" style="position:absolute;top:10px;right:10px;background:var(--hot);color:white;border:none;padding:5px 12px;border-radius:5px;font-size:11px;font-weight:700;cursor:pointer;">Copy</button>
      </div>

      <div style="background:rgba(255,212,77,0.08);border:1px solid rgba(255,212,77,0.2);border-radius:8px;padding:12px 14px;font-size:12px;color:var(--amber);line-height:1.6;margin-bottom:16px;">
        ‚ö† Your ad set names must include the pathway code at the front ‚Äî e.g. <strong>A1 - General Ads Batch 53</strong> or <strong>B2 - Retargeting ATC</strong>. If they don't yet, fill in the panels manually this week and rename them in Meta before next Friday.
      </div>

      <div class="modal-btns">
        <button class="btn btn-cancel" onclick="closeImportModal()">Cancel</button>
        <button class="btn btn-add" onclick="goToStep2()">I've got the JSON ‚Äî Next ‚Üí</button>
      </div>
    </div>

    <!-- STEP 2: PASTE JSON -->
    <div id="import-step2" style="display:none;">
      <div class="modal-title">STEP 2 ‚Äî PASTE THE JSON</div>
      <div style="font-size:12px;color:var(--label);margin-bottom:14px;line-height:1.7;">
        Copy the JSON block from Claude's response and paste it below. It should start with <code style="color:var(--gold);">{</code> and end with <code style="color:var(--gold);">}</code>.
      </div>
      <textarea id="json-input" style="height:200px;font-family:'DM Mono',monospace;font-size:11px;resize:vertical;" placeholder='Paste JSON here...&#10;&#10;{&#10;  "pathways": [&#10;    {&#10;      "id": "A1",&#10;      "adsLive": "47",&#10;      ...&#10;    }&#10;  ]&#10;}'></textarea>
      <div id="import-status" style="font-size:12px;min-height:18px;margin:8px 0;"></div>
      <div class="modal-btns">
        <button class="btn btn-cancel" onclick="goToStep1()">‚Üê Back</button>
        <button class="btn btn-add" onclick="applyJSON()">Fill Panels</button>
      </div>
    </div>

  </div>
</div>

<script>
// ‚îÄ‚îÄ EVE'S PROMPT ‚îÄ‚îÄ
const evePrompt = `You are analysing a Meta Business Manager CSV export for First or Nothing (FON).

ACTIVE PATHWAYS: A1, B2
(Add more pathway codes here as new ones open e.g. A2, B1 etc.)

NAMING CONVENTION: Each ad set name starts with the pathway code.
Examples: "A1 - General Ads Batch 53", "B2 - Retargeting ATC 30D"
Use the ad set name to determine which pathway each ad belongs to.

CSV DATA:
[PASTE YOUR META CSV HERE ‚Äî delete this line and paste the CSV]

YOUR TASK: For each active pathway calculate:
1. adsLive ‚Äî count of unique ads with delivery status "Active" (not paused/off)
2. earn7 ‚Äî total purchase conversion value (revenue) ‚Äî format as $X,XXX
3. spend7 ‚Äî total amount spent ‚Äî format as $X,XXX
4. roas7 ‚Äî earn7 divided by spend7 ‚Äî format as X.Xx
5. reelsLive ‚Äî count of active ads with "-R-" in the ad name (Reels)
6. staticsLive ‚Äî count of active ads with "-S-" in the ad name (Statics)

If a value cannot be determined from the CSV use "" (empty string).

Respond ONLY with raw JSON ‚Äî no explanation, no markdown, no code fences.

{
  "pathways": [
    {
      "id": "A1",
      "adsLive": "47",
      "earn7": "$12,450",
      "spend7": "$4,200",
      "roas7": "2.96x",
      "reelsLive": "30",
      "staticsLive": "17"
    },
    {
      "id": "B2",
      "adsLive": "12",
      "earn7": "$3,100",
      "spend7": "$980",
      "roas7": "3.16x",
      "reelsLive": "6",
      "staticsLive": "6"
    }
  ],
  "notes": "Any important observations ‚Äî data gaps, unusual spend, pathway not found etc."
}`;

document.getElementById('eve-prompt-box').textContent = evePrompt;

function copyEvePrompt(btn) {
  navigator.clipboard.writeText(evePrompt).then(() => {
    btn.textContent = 'Copied ‚úì';
    setTimeout(() => btn.textContent = 'Copy', 2000);
  }).catch(() => {
    const ta = document.createElement('textarea');
    ta.value = evePrompt;
    document.body.appendChild(ta);
    ta.select();
    document.execCommand('copy');
    document.body.removeChild(ta);
    btn.textContent = 'Copied ‚úì';
    setTimeout(() => btn.textContent = 'Copy', 2000);
  });
}

// ‚îÄ‚îÄ MODAL NAVIGATION ‚îÄ‚îÄ
function openImportModal() {
  goToStep1();
  document.getElementById('import-modal').style.display = 'flex';
}
function closeImportModal() {
  document.getElementById('import-modal').style.display = 'none';
  document.getElementById('json-input').value = '';
  setImportStatus('', '');
}
function goToStep1() {
  document.getElementById('import-step1').style.display = 'block';
  document.getElementById('import-step2').style.display = 'none';
  document.getElementById('step-ind-1').style.background = 'var(--hot)';
  document.getElementById('step-ind-2').style.background = 'var(--border)';
}
function goToStep2() {
  document.getElementById('import-step1').style.display = 'none';
  document.getElementById('import-step2').style.display = 'block';
  document.getElementById('step-ind-1').style.background = 'var(--green)';
  document.getElementById('step-ind-2').style.background = 'var(--hot)';
  document.getElementById('json-input').focus();
}
document.getElementById('import-modal').addEventListener('click', function(e) {
  if (e.target === this) closeImportModal();
});

// ‚îÄ‚îÄ APPLY JSON ‚îÄ‚îÄ
function applyJSON() {
  const raw = document.getElementById('json-input').value.trim();
  if (!raw) { setImportStatus('‚ö† Please paste the JSON from Claude first.', 'var(--amber)'); return; }

  let result;
  try {
    const clean = raw.replace(/```json|```/g, '').trim();
    result = JSON.parse(clean);
  } catch(e) {
    setImportStatus('‚ùå Could not read that JSON. Make sure you copied the full block starting with { and ending with }', 'var(--hot)');
    return;
  }

  let filled = 0;
  result.pathways.forEach(item => {
    const p = pathways.find(x => x.id === item.id);
    if (p) {
      if (item.adsLive)     p.adsLive     = item.adsLive;
      if (item.earn7)       p.earn7       = item.earn7;
      if (item.spend7)      p.spend7      = item.spend7;
      if (item.roas7)       p.roas7       = item.roas7;
      if (item.reelsLive)   p.reelsLive   = item.reelsLive;
      if (item.staticsLive) p.staticsLive = item.staticsLive;
      filled++;
    }
  });

  const notes = result.notes ? ` ‚Äî ${result.notes}` : '';
  setImportStatus(`‚úÖ ${filled} pathway${filled !== 1 ? 's' : ''} filled in.${notes}`, 'var(--green)');
  renderAll();
  setTimeout(() => closeImportModal(), 2200);
}

function setImportStatus(msg, color) {
  const el = document.getElementById('import-status');
  el.textContent = msg;
  el.style.color = color;
}

// ‚îÄ‚îÄ RENDER ALL ‚îÄ‚îÄ
function renderAll() {
  renderTabs();
  renderPathway();
  renderSuggestions();
  renderLockBar();
}

renderAll();
</script>
</body>
</html>
